module.exports = {
	apps: [
		{
			name: "sdm-app",
			script: "npm",
			args: "start -- -H 0.0.0.0 -p 3001",
			instances: 3,
			exec_mode: "cluster",
			watch: true,
			watch_delay: 1000,
			ignore_watch: [
				"node_modules",
				"logs",
				".git",
				".next",
				"public/uploads",
				"*.log",
			],
			env: {
				NODE_ENV: "production",
				PORT: 3001,
				HOST: "0.0.0.0",
			},
			env_development: {
				NODE_ENV: "development",
				PORT: 3001,
				HOST: "0.0.0.0",
			},
			log_file: "./logs/combined.log",
			out_file: "./logs/out.log",
			error_file: "./logs/error.log",
			log_date_format: "YYYY-MM-DD HH:mm:ss Z",
			max_memory_restart: "1G",
			min_uptime: "10s",
			max_restarts: 10,
			restart_delay: 4000,
			listen_timeout: 10000,
			kill_timeout: 5000,
			instance_var: "INSTANCE_ID",
			autorestart: true,
			cron_restart: "0 2 * * *",
			merge_logs: true,
			source_map_support: true,
			time: true,
		},
	],
	deploy: {
		production: {
			user: "node",
			host: "your-server-ip",
			ref: "origin/main",
			repo: "your-git-repo",
			path: "/var/www/sdm",
			"pre-deploy-local": "",
			"post-deploy":
				"npm install && npm run build && pm2 reload ecosystem.config.js --env production",
			"pre-setup": "",
		},
	},
};
